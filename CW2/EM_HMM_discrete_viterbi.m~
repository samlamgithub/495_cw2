function [ S_e ] = EM_HMM_discrete_viterbi( N, K, T, pi_e, A_e, E_e , Y)
%         N x T                         K x 1, K x K, K x NumObsers, N x T

NumObsers = size(E_e, 2);
S_e = zeros(N, T);
% log2(x)
%  [a, b] = max([3,4,5])

logPi = log2(pi_e);
logA = log2(A_e);
logE = log2(E_e);

for n = 1:N
    
    delta_probs = zeros(T, K);
    
    delta_probs(1, :) = logPi + logE(:, Y(n, 1));
    [nothing, S_e(n,1)] = max(delta_probs(1, :));
    
    for t = 2:T
         for k = 1:K
               % pro of end up in latent j at time t: from latent i at time t-1
               % delta(t, j) = C_t^-1 x p(x_t|ztj=1) max for i: delta(t-1,
               % i) x A(i to j)
             delta_probs(t, k) = logE(k, Y(n, t)) + max(delta_probs(t-1, :)' + logA(:, k));
             
             k2
             logE(k, Y(n, t))  + delta_probs(t-1, k2)' + logA(k2, k)
         end
         Se(n, t) = max();
    end
    
    
    
    
    
    
    
    
    
    
    
    
    
    
end


end


